var Hackpad = require('hackpad');
var async = require('async');
var getPadData = require('getPadData');

// Returns a JSON object listing the authors of the workspace and how many edits each one has made

var getWorkspaceData = function(hackpad, callback){
	
	var workspaceData = {};

	// Get a list of all the pad IDs in the workspace
	hackpad.list(function(err, padIds) {

		// Store the total number of pads
		workspaceData.totalPads = padIds.length;

		workspaceData.pads = [];

		// For each pad...
		async.mapSeries(padIds, getPadData, function(err, results){
			
			if(err){ console.log('Error!'); return; }

    		workspaceData.pads = results;

    		callback(null, workspaceData);

		});
	});
}

module.exports = getWorkspaceData