// getFrequencies
//
// Takes a (possibly nested) array of values.
// Returns a JSON object of key value pairs representing the number of times each value appears in the original array

var flattenArray = require('flattenArray');

function sortByKey(array, key) {
    return array.sort(function(a, b) {
        var x = a[key]; var y = b[key];
        return ((x < y) ? -1 : ((x > y) ? 1 : 0));
    });
}

var getMostActivePads = function(array){

	var totalEdits = [];

	array.forEach( function (pad){
        var item = {};
		item.padId = pad.padId;
		item.padTitle = pad.padTitle;
		item.padEdits = flattenArray(pad.padEdits).length;
		totalEdits.push(item);
	});

	// Sort by frequency, descending, top ten
	return sortByKey(totalEdits, 'padEdits').reverse().slice(0, 9);

}

module.exports = getMostActivePads;